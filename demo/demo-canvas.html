<!DOCTYPE html>
<html>
<head>
  <title>JSCPP test</title>
</head>

<body>
  <canvas id="gamecanvas" width="640" height="360" style="background: black;"></canvas>
  <p/>
</body>
<script src="../dist/JSCPP.js"></script>
<script type="text/javascript">
window.onload = function () {
  var code = "#include <iostream>"+
            "#include <indi9>"+
             "using namespace std;"+
             "int main() {"+
             '    fillRect(0, 0, 160, 90, "red");'+
             '    drawRect(100, 100, 260, 190, "blue");'+
             '    drawLine(0, 0, 100, 100, "yellow");'+
             '    drawText("Hello World", 8, 30, 22, "white");'+
             '    loadImage("panda", "https://upload.wikimedia.org/wikipedia/commons/b/bf/Farm-Fresh_emotion_face_panda.png");'+
             '    loadImage("hero", "https://upload.wikimedia.org/wikipedia/commons/thumb/1/11/Cc-by_new_white.svg/48px-Cc-by_new_white.svg.png");'+
             '    delay(500);'+
             '    drawImage("panda", 110, 110);'+
             '    drawImage("hero", 150, 120);'+
             "    return 0;"+
             "}"
  ;

  
  async function run(config) {
    config = config || {};
    if (!('stdio' in config)) {
      config.stdio = {
        write: function(s) {
          console.log(s);
        }
      }
    }
    config.debug = true;
    let mydebugger = JSCPP.run(code, '', config);
    let finished = false;
    do {
      window.debuggerPromise = undefined;
      finished = mydebugger.next();
      if (window.debuggerPromise) {
        await window.debuggerPromise;
      }
    } while (finished == false);
  }

  run();
}
</script>
</html>